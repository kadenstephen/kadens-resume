<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Form page for Kaden Stephen's Resume">
    <title>Form</title>

    <link type="text/css" rel="stylesheet" href="normalize.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans&family=Open+Sans:wght@300&family=Source+Sans+Pro:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="../styles/main.css" />
</head>


<body>
    <header>
      <div class="main-menu">
          <div class="menu-icon">
            <svg viewbox="0 0 60 60" width="60px" height="60px">
              <line x1="5%" y1="50%" x2="95%" y2="50%" />
              <line x1="5%" y1="50%" x2="95%" y2="50%" />
            </svg>
          </div>
        
        <nav>
          <h2 class="hidden">Main Menu</h2>
          <ul>
              <li><a href="https://kadenstephen.github.io/kadens-resume/">Home</a></li>
              <li><a>Contact</a></li>
              <li><a href="https://kadenstephen.github.io/kadens-resume/about/">About</a></li>
              <li><a href="https://kadenstephen.github.io/kadens-resume/resume/">Resume</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <div class="form-page">
      <h1 class="contact-kaden">Contact Kaden</h1>
        <section class="form-section">
          <svg id="contact-svg" x="0px" y="0px" viewbox="0 0 496.804 496.804" style="enable-background:new 0 0 496.804 496.804;" xml:space="preserve">
            <g id="contact-svg-code">
              <path id="XMLID_132_" d="M467.585,433.167c-4.972-12.719-17.23-21.089-30.888-21.089H51.416c-13.659,0-25.917,8.37-30.891,21.089   L3.069,477.834c-1.674,4.278-1.125,9.104,1.472,12.905c2.587,3.793,6.89,6.065,11.482,6.065h456.066   c4.593,0,8.895-2.272,11.482-6.065c2.594-3.801,3.146-8.627,1.472-12.905L467.585,433.167z"/>
              <path id="XMLID_131_" d="M64.353,377.85H423.75c18.315,0,33.162-14.846,33.162-33.159V190.167h-33.137L423.75,344.73l-359.439-0.04   l0.042-231.253h160.911v-33.12H64.353c-18.315,0-33.162,14.846-33.162,33.161V344.69C31.191,363.004,46.037,377.85,64.353,377.85z"/>
              <path id="XMLID_130_" d="M465.862,0h-178.65c-15.923,0-28.828,12.904-28.828,28.826v99.393c0,15.922,12.905,28.826,28.828,28.826   h41.974l-17.838,48.008c-0.47,1.268-0.099,2.7,0.938,3.573c0.598,0.51,1.342,0.775,2.094,0.775c0.542,0,1.091-0.137,1.586-0.42   l91.808-51.937h58.088c15.923,0,28.828-12.904,28.828-28.826V28.826C494.69,12.904,481.784,0,465.862,0z"/>
            </g>
          </svg>
                   
      <form name="contact-him">
            
            <label for="name">Full name:</label>
            <input type="text" name="name" id="name">
      
            <label for="email-address">Email address:</label>
            <input type="email" name="email" id="email-address" required>
      
            <label for="phone-number">Phone number:</label>
            <input type="tel" name="phone" id="phone-number">
      
            <label for="month">Current date:</label>
            <input type="month" name="month" id="month">
      
            <fieldset>
              <legend>What interests you most about Kaden? (Check all that apply)</legend>
      
              <input type="checkbox" id="finance-background" name="interests" value="Finance-background" checked>
              <label for="finance-background">His finance background</label>
      
              <input type="checkbox" id="great-communicator" name="interests" value="great-communicator">
              <label for="great-communicator">Great communicator</label>
      
              <input type="checkbox" id="adaptable" name="interests" value="adaptable">
              <label for="adaptable">His traveling experience</label>
            </fieldset>
      
            <fieldset>
              <legend>How would you like to contact Kaden?</legend>
      
              <input type="radio" id="lunch" name="meeting" value="out-for-lunch">
              <label for="lunch">Out For Lunch</label>
      
              <input type="radio" id="zoom" name="meeting" value="zoom-call">
              <label for="zoom">Zoom Call</label>
      
              <input type="radio" id="phone" name="meeting" value="phone-call">
              <label for="phone">Phone Call</label>
      
              <input type="radio" id="email" name="meeting" value="email">
              <label for="email">Email</label>
      
            </fieldset>
      
            <label for="details">Tell Kaden why you'd like to meet with him:</label>
            <textarea name="details" id="details" rows="10" placeholder="1-2 sentences"></textarea>
      
            <button class="form-button" type="submit">S U B M I T</button>
      
      </form>
      </section>
    </div>

  <div class="loading hidden">
    <div class="loader"></div>
  </div>

  <p class="success-message hidden">Kaden will reach out to you soon!</p>
<p class="error-message hidden">Sorry, there was a problem submitting your form...</p>
  <script>
    window.addEventListener("DOMContentLoaded", () => {
  document.querySelector(".menu-icon").addEventListener("click", () => {
    document.querySelector(".main-menu").classList.toggle("menu-show");
    });
  });
  </script>

<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbxVtvYR2lzm27Dcb9Io5X63gAKkIXLUQBJnV1aat58qCPahceUj/exec'

// add a name attribute to your <form> and enter its value here 
const form = document.forms['contact-him']

// enter the value of your checkboxes' name attribute
const checkboxName = "interests"

// set these to your loader and message classes
const loading = document.querySelector('.loading')
const successMessage = document.querySelector('.success-message')
const errorMessage = document.querySelector('.error-message')

// this will run when the submit button is clicked
form.addEventListener('submit', event => {
  // stops default form handling so we can submit it to Google Sheets instead
  event.preventDefault()

  // show the loader and hide form
  form.classList.add('hidden')
  loading.classList.remove('hidden')

  // collect the form values into an object that can be sent to Google Sheets
  let fd = new FormData(form);

  /* If more than one checkbox is selected, the form will have multiple keys 
     (checkbox name). Only the first checkbox value would be entered into 
     Google Sheets. 
     To get around this, concat all the selected checkbox values into a single 
     string and send that value */

  // grab all the selected values stored as key/value pairs of checkboxName/value
  let checkBoxValues = fd.getAll(checkboxName)

  // then delete them from the formData object
  fd.delete(checkboxName);

  // create a string
  let text = ""
  if (checkBoxValues.length <= 2) {
    text = checkBoxValues.join(" and ")
  } else {
    let end = checkBoxValues.pop();
    text = checkBoxValues.join(", ");
    text += ", and " + end;
  }
  // add the key/value pair checkboxName/text back to the formData object
  fd.append(checkboxName, text);

  // use an asynchronous request to POST your formData object to your Google Sheet
  fetch(scriptURL, {
      method: 'POST',
      body: fd,
    })
    // if response ok, show success message and hide loader, else display error
    .then(response => {
      loading.classList.add('hidden')
      if (response.ok) {
        console.log('Success!', response)
        successMessage.classList.remove('hidden')
      } else {
        console.log("Something has gone terribly wrong and I'm rather afraid I don't know what to do.",
          response)
        errorMessage.classList.remove('hidden')
      }
    })
    // if error, show error message and hide loader
    .catch(error => {
      console.error('Error!', error.message)
      errorMessage.classList.remove('hidden')
      loading.classList.add('hidden')
    })
})
</script>

</body>
</html>